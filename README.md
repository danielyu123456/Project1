# DBN 알고리즘 (Deep Belief Network-심층 신뢰 신경망)

기계학습에 사용되는 그래프 생성 모델(generative graphical model)이다. 이는 알고리즘 그래프를 생성하는데, 한 개의 입력층에 각각의 잠재변수를 학습하기 위한 다층의 은닉층으로 구성되어 있다. 각층은 제한된 볼츠만 머신(RBM)으로 이루어져 있는데 계층간 연결은 있지만 계층내에선 연결이 없다는 점이 특징이다. 각 층에서 선행학습으로 가중치를 학습하고 초기에 임의로 설정된 가중치를 조정하는 것으로 오차를 줄일 수 있다.

<img width="607" alt="사진1" src="https://github.com/danielyu123456/Project1/assets/170755250/8eb4735f-fda6-4b02-9346-0380b87b26fa">

## DBN의 역사
DBN은 알고리즘 분야에서 꽤 역사적인 의미를 가지고 있다. 2006년 제프린 힌튼이 ‘A fast learning algorithm for deep belief nets’**라는 논문을 발표한다. 여기서 최초로 DBN이라는 새로운 알고리즘이 소개되었고 기존 알고리즘의 문제점들을 해결했다. 두가지 예로 사전 학습(Pretraining)을 통해 기울기 소실을 해결했고, 학습 도중 의도적으로 데이터를 누락시키는 ‘Drop out’으로 새로운 데이터를 소화시키지 못하던 기존 알고리즘의 문제를 해결한 것이다. 이것이 오늘날의 AI 딥러닝 전성시대를 열었다고 해도 과언이 아니다.


## RBM은 무엇인가?
DBN을 구성하는 각 층인 RBM을 간단하게 알아볼 필요가 있다. RBM은 Restricted Boltzmann Machines의 약자로 데이터가 입력되는 가시층(visible layer)과 가중치가 학습되는 은닉층으로 구성되어 있다. 같은 층의 노드들과는 전혀 연결되어 있지 않으며, 이 구조 때문에 ‘Restricted’ Boltzmann Machines라는 이름이 붙게 되었다.
가장 간단한 RBM 구조식 하나를 예로 들어보겠다.

<img width="607" alt="사진2" src="https://github.com/danielyu123456/Project1/assets/170755250/93a30188-3de7-4b11-bd7b-4f511090f685">


입력층에 입력 값 X를 넣는다 가정했을 때 은닉층의 가중치 W와 곱해진다. 
그리고 바이어스(b)를 더한 값인 (X*W+b)을 활성함수 f()에 넣으면 값 a가 나오는 방식이다.
##### 정리
    activation f((weight w * input x) + bias b ) = output a

## DBN의 강・약점
### 강점
DBN의 가장 큰 강점은 역시 효율적인 비지도 학습 이다. 비지도 학습이란 알고리즘의 결과값을 미리 제공하지 않고 인공지능이 입력 단계에서 패턴과 상하관계를 찾아내는 머신 러닝의 일종이다. 
결과값을 미리 알 필요없이 입력 값으로만 학습을 수행하기 때문에 더 복잡한 정보를 처리할 수 있고, 특히 변칙이나 이상을 감지하는데 유용하다.

    A. 사전 학습: 각 층을 단계적으로 학습하여 초기 가중치를 효과적으로 설정할 수 있다.
    B. 특징 학습: 비지도 학습을 통해 데이터의 복잡한 특징을 추출하고 학습할 수 있다. 여러 층의 RBM을 통해 사전학습한후 어느정도 보정된 가중치를 계산하기 때문에 학습데이터가 부족한 데이터를 처리하는데 특히 유용하다.
    C. 쉬운 초기화: 비지도 학습을 통해 가중치를 효과적으로 초기화 할 수 있어, 심층 신경망 학습 중 기울기 소실의 발생을 최소화할 수 있다.
    D. 여러 층의 RBM으로 구성되어 있어 새로운 데이터를 추가하거나 구조 자체를 변경하기에 다른 알고리즘에 비해 상대적으로 쉽다.
### 약점
가장 큰 약점이라고 할 수 있는 것은 다수의 은닉층을 통한 비지도학습을 통해 학습하기 때문에 각 RBM층을 개별적으로 학습하는 과정에서 많은 시간이 소요된다는 점이다. 또한 더욱 정교한 결과값을 위해 RBM을 계속 쌓는 과정에서 알고리즘 모델이 지나치게 복잡해지고 오류가 발생할 수 있다.

## DBN과 DNN 구분
두 모델 다 입력층과 출력층 사이에 은닉 신경망을 다수 쌓아놓은 구조인 점에서 구조적으로 유사하다. 하지만 DBN은 RBM만을 은닉층으로 쌓는다는 점이 차이점이라고 볼 수 있다. 따라서 DBN이 RBM을 통한 비지도학습으로 학습한다면 DNN은 결과값이 정해진 지도학습으로 학습한다. DBN은 입력을 재구성하고 백프로프(back-prop)로 미세 조정하기 위해 미리 처리되지만, DNN은 백프로프로 완전히 감독되는 교육을 받는다. DNN은 학습량이 많은 데이터를 처리하는데 유용하다면 DBN은 학습량이 적은 또는 교육 세트가 작은 경우에 유용하게 사용된다. 


## DBN 코드설명
- 라이브러리 가져오기: 데이터 처리(numpy, pandas), 기계 학습 모델(scikit-learn) 및 딥 러닝(tensorflow)을 위한 필수 Python 라이브러리를 가져옵니다.
- 데이터 세트 로드: 손으로 쓴 숫자의 28×28 픽셀 이미지 모음인 MNIST 데이터 세트는 scikit-learn의 fetch_openml을 사용하여 가져옵니다. 이 데이터 세트는 분류 알고리즘을 벤치마킹하는 데 일반적으로 사용됩니다.
- 전처리: 데이터 세트는 train_test_split을 사용하여 훈련 세트와 테스트 세트로 분할됩니다. 그런 다음 StandardScaler를 사용하여 데이터의 크기를 조정하여 정규화하며, 이는 종종 신경망의 성능을 향상시킵니다.
- RBM 레이어: 제한된 볼츠만 머신(RBM)은 지정된 수의 구성 요소와 학습 속도로 초기화됩니다. RBM은 입력을 재구성하여 데이터에서 패턴을 찾는 비지도 신경망입니다.
- 분류기 레이어: 로지스틱 회귀 분류기가 최종 예측 레이어로 선택됩니다. 로지스틱 회귀는 분류 작업을 위한 간단하면서도 효과적인 선형 모델입니다.
- DBN 파이프라인: RBM과 로지스틱 회귀 모델은 파이프라인으로 함께 연결됩니다. 이를 통해 RBM(특징 추출용)을 순차적으로 적용한 후 로지스틱 회귀(분류용)를 수행할 수 있습니다.
- 훈련: DBN을 구성하는 파이프라인은 전처리된 훈련 데이터(X_train_scaled)에 대해 훈련됩니다. RBM은 로지스틱 회귀 모델에서 숫자를 분류하는 데 사용되는 기능을 학습합니다.
- 평가: 마지막으로 훈련된 DBN의 성능이 테스트 세트에서 평가됩니다. 모델의 성능을 정량적으로 측정하기 위해 분류 정확도(dbn_score)가 인쇄됩니다.
<img width="653" alt="사진3" src="https://github.com/danielyu123456/Project1/assets/170755250/45e64e02-8307-4c81-a001-1494826570d7">

<img width="543" alt="사진4" src="https://github.com/danielyu123456/Project1/assets/170755250/53a715ba-5029-442a-9547-f68d6bc7a1d3">


출력에는 20회 반복을 통한 DBN(Deep Belief Network)의 훈련 진행 상황이 표시됩니다. 각 반복 중에 DBN의 RBM 부분은 데이터 구조를 이해하는 방법을 학습합니다. "의사 가능성"은 RBM이 데이터를 얼마나 잘 모델링하는지 추정하는 데 사용되는 척도입니다. 그러나 주어진 값은 음수이고 크기가 증가합니다. 이는 모델이 학습함에 따라 의사 가능성이 증가(또는 손실 감소)할 것으로 예상하므로 일반적으로 발생해서는 안 됩니다.

훈련 후 DBN은 약 21.14%의 분류 점수를 달성했습니다. 이 점수는 정확성을 측정하는 방법입니다. 이는 DBN이 테스트 데이터 세트에서 숫자 클래스를 21.14%의 시간 동안 정확하게 예측했음을 알려줍니다. 이는 매우 높은 점수가 아니며, 이는 모델이 이 작업에서 제대로 수행되지 않았음을 나타냅니다.







## 참고
- DBN의 역사 - [AI 이야기] 인공지능의 결정적 순간들, 세 번째 순서 (letr.ai) https://www.letr.ai/blog/story-20211112-1
- RBM 정의,구조 - 초보자용 RBM(Restricted Boltzmann Machines) 튜토리얼 | by 안종찬 | Medium https://medium.com/@ahnchan2/초보자용-rbm-restricted-boltzmann-machines-튜토리얼-791ce740a2f0
- DBN 강점 - 코딩의 시작, TCP School https://www.tcpschool.com/deep2018/deep2018_deeplearning_algorithm
- 비지도학습 - 비지도 학습(Unsupervised Learning) 이해를 돕는 심플 가이드 (appier.com) https://www.appier.com/ko-kr/blog/a-simple-guide-to-unsupervised-learning
- DBN과 DNN 구분 - 딥러닝(Deep Learning) 알고리즘 이해하기 : 네이버 블로그 (naver.com) 마지막 단락 https://m.blog.naver.com/sundooedu/221211368089
